<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:replace="commons :: header(~{::title},~{::script},~{::style})">
    <title>产品评分</title>
    <style type="text/css">
        .sidebar {
            position: fixed;
            top: 51px;
            bottom: 0;
            left: 0;
            z-index: 1000;
            display: block;
            padding: 20px;
            overflow-x: hidden;
            overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
            background-color: #f5f5f5;
            border-right: 1px solid #eee;
          }
    </style>
    <script type="text/javascript">
    
        window.onload = function(){
            
            toastr.options.positionClass = 'toast-bottom-left';
            
            
            var operateEvents = {'click .update': function (e, value, row, index) {
                updateForm.item = row;
                $('#updateModal').modal('show');
            },'click .delete': function (e, value, row, index) {
                tableApp.delete(row.companyId);
            }};
            
            var queryForm = new Vue({
                el:'#queryForm',
                data:{item:{}},
                methods:{
                    query:function(){
                        $('#table').bootstrapTable('refresh', {silent: true});
                    }
                }
            });
            
            var addForm = new Vue({
                el:'#addForm',
                data:{item:{}
                },
                methods:{
                    add:function(){
                        this.$http.post('companyscore/add',this.item).then(response => {
                            // success callback
                            if(response.body.errorCode == '0000'){
                                $('#addModal').modal('hide')
                                $('#table').bootstrapTable('refresh', {silent: true});
                                toastr.success('保存成功');
                            }else{
                                toastr.error('保存失败'+response.body.errorMsg);
                            }
                        }, response => {
                            toastr.error('保存失败'+response.body.message);
                        });
                    }
                }
            });
            
            var updateForm = new Vue({
                el:'#updateForm',
                data:{item:{}},
                methods:{
                    update:function(){
                        this.$http.post('companyscore/modify',this.item).then(response => {
                            // success callback
                            if(response.body.errorCode == '0000'){
                                $('#updateModal').modal('hide')
                                $('#table').bootstrapTable('refresh', {silent: true});
                                toastr.success('更新成功');
                            }else{
                                toastr.error('更新失败'+response.body.errorMsg);
                            }
                        }, response => {
                            toastr.error('更新失败'+response.body.message);
                        });
                    }
                }
            });
            
            var tableApp = new Vue({
                el:'#tableApp',
                data:{item:{}},
                mounted: function () {
                  // `this` 指向 vm 实例
                    $('#table').bootstrapTable({
                        columns: [{
                            field: 'entryPerson',
                            title: '录入人'
                        }, {
                            field: 'entryTime',
                            title: '录入时间'
                        }, {
                            field: 'companyId',
                            title: '公司编号'
                        }, {
                            field: 'productId',
                            title: '产品编号'
                        },{
                            field: 'jdNo',
                            title: '尽调编号'
                        }, {
                            field: 'capital',
                            title: '投资策略分类'
                        }, {
                            field: 'publishState',
                            title: '净值日期'
                        }, {
                            field: 'adminScale',
                            title: '产品成立日期'
                        }, {
                            field: 'investment',
                            title: '1. 最新单位净值'
                        }, {
                            field: 'teamState',
                            title: '2. 复权累计净值'
                        }, {
                            field: 'riskState',
                            title: '3. 年化收益率'
                        }, {
                            field: 'productProfit',
                            title: '4. 最大连续回撤'
                        }, {
                            field: 'reputation',
                            title: '5. 夏普比率'
                        }, {
                            field: 'spreadState',
                            title: '6. 信息比率'
                        }, {
                            field: 'cooperation',
                            title: '7. 卡马比率'
                        }, {
                            field: 'spreadState',
                            title: '8. 索提诺比率'
                        }, {
                            field: 'cooperation',
                            title: '9. D-Ratio'
                        }, {
                            field: 'spreadState',
                            title: '10. D-Ratio_'
                        }, {
                            field: 'cooperation',
                            title: '11.综合评价'
                        }, {
                            title: '操作',
                            events: operateEvents,
                            formatter:this.formatter()
                        }],
                        data: [],
                        pagination: true,
                        url: "companyscore/selectbyconditions",
                        method: "post",
                        toolbar: "#toolbar"
                    });
                },
                methods:{
                    delete:function(companyScoreId){
                        this.$http.get('companyscore/delete?companyScoreId='+companyScoreId).then(response => {
                            // success callback
                            if(response.body.errorCode == '0000'){
                                $('#updateModal').modal('hide')
                                $('#table').bootstrapTable('refresh', {silent: true});
                                toastr.success('删除成功');
                            }else{
                                toastr.error('删除失败'+response.body.errorMsg);
                            }
                        }, response => {
                            toastr.error('删除失败'+response.body.message);
                        });
                    },
                    openModal:function(row){
                        this.item = row;
                        $('#updateModal').modal('show');
                        
                    },
                    formatter:function(value, row, index, field) {
                        return '<button type="button" class="update btn btn-default btn-sm" title="设置">'
                                + '<i class="glyphicon glyphicon-cog"></i>'
                                + '</button> &nbsp;'
                        
                                + '<button type="button" class="delete btn btn-default btn-sm" title="删除">'
                                + '<i class="glyphicon glyphicon-trash"></i>'
                            + '</button>';
                    }
                }
            });
        }
    </script>
</head>
<body>
        <div th:include="commons :: navbar"></div>
        <div class="container-fluid">
        <div class="row-fluid">
            <div class="col-sm-3 col-md-2 sidebar">
                <div th:include="commons :: leftnavbar"></div>
            </div>
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            
            
                <div class="row placeholders">
            
                        <!-- 查询条件表单 -->
                      <form id="queryForm" class="form-horizontal" style="margin-top: 30px">
                          <div class="form-group">
                                
                                <label class="col-sm-2 col-md-1 control-label">公司编号</label>
                                <div class="col-sm-10 col-md-2">
                                    <input type="text" class="form-control" v-model="item.companyId">
                                </div>
                          
                                <label class="col-sm-2 col-md-1 control-label">尽调编号</label>
                                <div class="col-sm-10 col-md-2">
                                  <input type="text" class="form-control" v-model="item.jdNo">
                                </div>
                                
                                <label class="col-sm-2 col-md-1 control-label">录入时间</label>
                                <div class="col-sm-10 col-md-2">
                                    <div class="block">
                                        <el-date-picker
                                          v-model="item.entryTime"
                                          type="date"
                                          placeholder="选择日期">
                                        </el-date-picker>
                                    </div>
                                </div>
                            
                          </div>
                          
                          <div class="form-group">
                                
                                
                            
                          </div>
                          
                          <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10 col-md-2 col-md-offset-4 ">
                              <input class="btn btn-default col-xs-7" type="button" value="查询" @click="query()">
                            </div>
                          </div>
                      </form>
                      <!-- 查询条件表单结束 -->
                </div>
                
                <div class="table-responsive" id="tableApp">
                    <div id="toolbar" class="btn-group">
                        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#addModal" title="新增记录">
                            <i class="glyphicon glyphicon-plus">新增记录</i>
                        </button>
                    </div>
                    <table id="table"></table>
                    
                    
                </div>
                
            </div>
            
        </div>
    </div>
    
    <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content" id="addForm">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">新建管理人评分</h4>
          </div>
          <div class="modal-body">
              <form class="form-horizontal" role="form">
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">录入人</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.entryPerson" placeholder="" />
                    </div>
                    
                    <label class="col-sm-2 control-label">公司编号</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.companyId"  placeholder="" />
                    </div>
                    
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">尽调编号</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.jdNo" placeholder="" />
                    </div>
                  </div>
                  
                  <hr>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">1. 资本实力</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control" v-model="item.capital" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">2. 产品发行情况</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.publishState" placeholder="" />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">3. 管理规模</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control" v-model="item.adminScale" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">4. 投资安排</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control" v-model="item.investment" placeholder="" />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">5. 管理团队状况 </label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.teamState" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">6. 合规风控体系 </label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.riskState" placeholder="" />
                    </div>
                  </div>
                  
                  <hr>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">7. 产品收益</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.productProfit" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">8. 业内知名度</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.reputation"  placeholder="" />
                    </div>
                  </div>
                  
                  <hr>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">9. 产品推广性</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.spreadState" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">10. 过往合作情况</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.cooperation"  placeholder="" />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">11. 合计评分</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.totalScore" placeholder="" />
                    </div>
                  </div>
                </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            <button type="button" class="btn btn-primary" v-on:click="add()">保存</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content" id="updateForm">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">更新管理人基本信息</h4>
          </div>
          <div class="modal-body">
              <form class="form-horizontal" role="form">
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">录入人</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.entryPerson" placeholder="" />
                    </div>
                    
                    <label class="col-sm-2 control-label">公司编号</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.companyId"  placeholder="" />
                    </div>
                    
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">尽调编号</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.jdNo" placeholder="" />
                    </div>
                  </div>
                  
                  <hr>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">1. 资本实力</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control" v-model="item.capital" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">2. 产品发行情况</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.publishState" placeholder="" />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">3. 管理规模</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control" v-model="item.adminScale" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">4. 投资安排</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control" v-model="item.investment" placeholder="" />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">5. 管理团队状况 </label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.teamState" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">6. 合规风控体系 </label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.riskState" placeholder="" />
                    </div>
                  </div>
                  
                  <hr>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">7. 产品收益</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.productProfit" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">8. 业内知名度</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.reputation"  placeholder="" />
                    </div>
                  </div>
                  
                  <hr>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">9. 产品推广性</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.spreadState" placeholder="" />
                    </div>
                    <label class="col-sm-2 control-label">10. 过往合作情况</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.cooperation"  placeholder="" />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label class="col-sm-3 control-label">11. 合计评分</label>
                    <div class="col-sm-3">
                      <input type="text" class="form-control" v-model="item.totalScore" placeholder="" />
                    </div>
                  </div>
                </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            <button type="button" class="btn btn-primary" v-on:click="update()">更新</button>
          </div>
        </div>
      </div>
    </div>

</body>
</html>